\documentclass[10pt,twocolumn,letterpaper]{article}

\usepackage{cvpr}
\usepackage{times}
\usepackage{epsfig}
\usepackage{graphicx}
\graphicspath{{./img/}}
\usepackage{amsmath}
\usepackage{amssymb,bbm,xcolor}
\usepackage[breaklinks=true,bookmarks=false]{hyperref}
\usepackage{lipsum}
\usepackage{listings}
\usepackage{mathtools,eucal}
\usepackage{graphicx}

\usepackage{bbold}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}
\usepackage{booktabs, multicol, xcolor}
\usepackage[shortlabels]{enumitem}
\usepackage{changepage}
\cvprfinalcopy % *** Uncomment this line for the final submission
\setcounter{page}{1}
\renewcommand{\figurename}{Figure}
\usepackage{amsmath}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathAlphabet\mathbfcal{OMS}{cmsy}{b}{n}
\usepackage[T1]{fontenc}
\usepackage{flushend}

% Include other packages here, before hyperref.

% If you comment hyperref and then uncomment it, you should delete
% egpaper.aux before re-running latex.  (Or just hit 'q' on the first latex
% run, let it finish, and you should be clear).
\usepackage[breaklinks=true,bookmarks=false]{hyperref}

\cvprfinalcopy % *** Uncomment this line for the final submission

% Pages are numbered in submission mode, and unnumbered in camera-ready
%\ifcvprfinal\pagestyle{empty}\fi
\setcounter{page}{1}

\begin{document}
\title{\vspace{-2cm}Automatic Image Colorization: Comparative Overview}
\author{Bigarella Chiara\\
{\tt\small Student nr. 2004248}
% For a paper whose authors are all at the same institution,
% omit the following lines up until the closing ``}''.
% Additional authors and addresses can be added with ``\and'',
% just like the second author.
% To save space, use either the email address or home page, not both
\and
Poletti Silvia\\
{\tt\small Student nr. 1239133}
}

\maketitle
%\thispagestyle{empty}

%%%%%%%%% ABSTRACT
\begin{abstract}
   The colorization of greyscale images is an ill-posed problem that was approached in different ways in literature. This project provides a comparative analysis concerning five pre-trained colorization models and a cartoonization-based baseline of our invention. The performances are assessed through both quantitative and qualitative metrics, with a final evaluation of the results with respect to image filtering. 
\end{abstract}

\input{intro}
\input{related-work}
\input{dataset}

\section{Methods}
In this section, we propose a simple autoencoder based on cartoonization as baseline. Then, we introduce some state-of-the-art pre-trained models taken from the literature. The architectures of the proposed methods are reported in the Appendix.

\input{baseline}
\input{dahl}
\input{zhang}
\input{siggraph}
\input{chromagan}

\begin{table*}[ht]
	\begin{center}
		\begin{adjustwidth}{-1.3cm}{}
			\begin{tabular}{c|ccccccccc}
				&\textbf{Original} & \textbf{B\&W} & \textbf{Baseline w/c}&\textbf{Baseline} & \textbf{Dahl} & \textbf{Eccv16} & \textbf{Siggraph17} & \textbf{ChromaGAN} & \textbf{InstColorization}  \\
				\midrule
				\textbf{Pre-trained} & 74.5\% & 43.1\% & 32.5\% & 34.0\% & 39.8\% & 42.7\% & 43.2\% & 46.8\% & 49.5\% \\
				\midrule
				\textbf{Feature Extraction} & 97.2\% & 84.2\% & 79.4\% & 80.4\% & 87.8\% & 87.6\% &  88.9\%   &  90.2\% &       90.0\% \\
				\midrule
				\textbf{Finetuning} & 99.7\% & 63.0\% & 58.4\% & 63.6\% & 64.4\% & 80.9\% &  79.9\%   &  77.9\% &       73.7\% \\
			\end{tabular}
		\end{adjustwidth}
	\end{center}
	\caption{{\small  Summary of the classification accuracy of Alexnet in three different settings: Alexnet pre-trained on Imagenet, Alexnet feature extraction for the ImageNet subset, AlexNet finetuning for the Birds and Flowers dataset.}}
	\label{tab:pre-trained}
\end{table*}

\begin{figure*}[ht]
	\centering
	\captionsetup[subfigure]{labelformat=empty}
	\begin{subfigure}[b]{0.1\textwidth}
		\centering
		\includegraphics[width=2cm]{or - imgnet.jpeg}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.1\textwidth}
		\includegraphics[width=2cm]{b - imgnet.jpeg}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.1\textwidth}
		\includegraphics[width=2cm]{bw - imgnet.jpeg}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.1\textwidth}
		\includegraphics[width=2cm]{d - imgnet.jpeg}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.1\textwidth}
		\includegraphics[width=2cm]{z - imgnet2.jpeg}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.1\textwidth}
		\includegraphics[width=2cm]{si - imgnet2.jpeg}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.1\textwidth}
		\includegraphics[width=2cm]{chr - imgnet2.jpeg}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.1\textwidth}
		\includegraphics[width=2cm]{su - imgnet.png}
	\end{subfigure}
	
	\vspace{0.1cm}
	\begin{subfigure}[b]{0.1\textwidth}
		\centering
		\includegraphics[width=2cm]{or - flamingo.jpg}
		\caption{Original}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.1\textwidth}
		\includegraphics[width=2cm]{bw - flamingo.jpg}
		\caption{Baseline w/c}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.1\textwidth}
		\includegraphics[width=2cm]{b - flamingo.jpg}
		\caption{Baseline}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.1\textwidth}
		\includegraphics[width=2cm]{d - flamingo.jpg}
		\caption{Dahl}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.1\textwidth}
		\includegraphics[width=2cm]{z - flamingo.jpg}
		\caption{Eccv16}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.1\textwidth}
		\includegraphics[width=2cm]{si- flamingo.jpg}
		\caption{Siggraph17}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.1\textwidth}
		\includegraphics[width=2cm]{chr - flamingo.jpg}
		\caption{ChromaGAN}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.1\textwidth}
		\includegraphics[width=2cm]{su - flamingo.png}
		\caption{InstColoriz.}
	\end{subfigure}
	\caption{{\small Colorization comparison on two images from ImageNet Church (first row) and Bird Species Flamingo (second row).}}
	\label{fig:imagenet}
\end{figure*}

\input{su}

\section{Experiments}
To compare the results of each model, we computed several metrics: classification with AlexNet, LPIPS, PSNR and SSIM
(all quantitative metrics) and a Turing test on a few images (qualitative metric). Finally, we applied image filtering to evaluate possible improvements in the performances.

\begin{table*}[ht]
	\begin{center}
		\begin{tabular}{c|ccccccc}
			& \textbf{Baseline w/c}&\textbf{Baseline} & \textbf{Dahl} & \textbf{Eccv16} & \textbf{Siggraph17} & \textbf{ChromaGAN} & \textbf{InstColorization}  \\
			\midrule
			\textbf{PSNR} & - & - & 16.87 & 20.88 & 22.19 & 21.66 & 21.41 \\
			\midrule
			\textbf{SSIM} & - & - & 0.56 & 0.86 & 0.87 & 0.87 & 0.88 \\
			\midrule
			\textbf{LPIPS} & 0.28 & 0.28 & 0.36 & 0.23 & 0.20 & 0.21 & 0.23 \\
		\end{tabular}
	\end{center}
	\caption{{\small  Summary of the PSNR, SSIM and LPIPS metrics computed on the different models.}}
	\label{tab:metrics}
\end{table*}

\input{classification}
\input{metrics}
\input{turing}
\input{filter}

\input{conclusion}

\clearpage
\onecolumn

\section*{Source Code}
Our code and data are available at the Github repository https://github.com/ChiaraBi/vision-project.

{\small
\bibliographystyle{ieee_fullname}
\bibliography{egbib}
}


\section*{Appendix}
This section contain the graphical representation of the proposed models' architectures.

\begin{figure}[htbp]
	\centering
	\includegraphics[width=6cm]{diagram dahl.jpg}
	\caption{Dahl architecture.}
	\label{fig:dahl}
\end{figure}

\begin{figure}[t]
	\centering
	
	\begin{subfigure}[b]{0.5\textwidth}
		\centering
		\begin{adjustwidth}{-3cm}{}
			\includegraphics[width=15cm]{quantization}
		\end{adjustwidth}
		\caption{Quantization of the \textit{ab} output space.}
		\label{fig:q}
	\end{subfigure}
	
	\begin{subfigure}[b]{0.5\textwidth}
		\centering
		\begin{adjustwidth}{-3cm}{}
			\includegraphics[width=15cm]{diagram zhang}
		\end{adjustwidth}
		\caption{Zhang  architecture.}
		\label{fig:zh}
	\end{subfigure}
	
	\caption{{\small Zhang approach and architecture.}}
	\label{fig:zhang}
\end{figure}

\begin{figure}[htbp]
	\centering
	\includegraphics[width=15cm]{diagram siggraph}
	\caption{Siggraph architecture.}
	\label{fig:si}
\end{figure}

\begin{figure}[htbp]
	\centering
	\includegraphics[width=15cm]{diagram chr.jpg}
	\caption{ChromaGAN architecture. The discriminator (green) is combined with the generator, which consists of two subnetworks: one for chrominance (yellow, purple, red, blue) and the other for class distribution (yellow, red, gray).}
	\label{fig:chr}
\end{figure}

\begin{figure}[t]
	\centering
	
	\begin{subfigure}[b]{0.5\textwidth}
		\centering
		\begin{adjustwidth}{-2cm}{}
		\includegraphics[width=13cm]{diagram su1}
		\end{adjustwidth}
		\caption{Complete process overview.}
		\label{fig:su1}
	\end{subfigure}
	
	\begin{subfigure}[b]{0.5\textwidth}
		\centering
		\begin{adjustwidth}{-2cm}{}
			\includegraphics[width=13cm]{diagram su2}
		\end{adjustwidth}
		\caption{Fusion module at the j-th layer.}
		\label{fig:su2}
	\end{subfigure}

	\caption{{\small InstColorization approach and architecture.}}
\label{fig:su}
\end{figure}

\end{document}
